if(window.navigationInitialized)console.log("Навигация уже инициализирована, пропускаем повторную инициализацию");else{window.navigationInitialized=!0;let s=null;const a=()=>{const t=document.querySelector(".header");if(!t)return;const n=window.scrollY>10;n&&s!=="scrolled"?(s="scrolled",t.classList.add("bg-gray-900/85","shadow-lg","shadow-black/40","backdrop-saturate-150"),t.classList.remove("bg-transparent"),t.classList.remove("border-transparent"),t.classList.add("border-gray-800/60")):!n&&s!=="top"&&(s="top",t.classList.remove("bg-gray-900/85","shadow-lg","shadow-black/40","backdrop-saturate-150","border-gray-800/60"),t.classList.add("bg-transparent","border-transparent"))};window.addEventListener("scroll",a,{passive:!0}),window.addEventListener("DOMContentLoaded",a),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("menuButton"),n=document.getElementById("mobileMenu");if(!t||!n){console.error("Элементы меню не найдены");return}let e=!1;t.addEventListener("click",function(o){o.stopPropagation(),e=!e,e?(n.classList.remove("hidden"),t.innerHTML='<i class="fas fa-times text-xl"></i>'):(n.classList.add("hidden"),t.innerHTML='<i class="fas fa-bars text-xl"></i>')}),n.querySelectorAll("a").forEach(o=>{o.addEventListener("click",function(){n.classList.add("hidden"),t.innerHTML='<i class="fas fa-bars text-xl"></i>',e=!1})}),document.addEventListener("click",function(o){const r=o.target;r&&!t.contains(r)&&!n.contains(r)&&e&&(n.classList.add("hidden"),t.innerHTML='<i class="fas fa-bars text-xl"></i>',e=!1)}),window.authChecked||(window.authChecked=!0,i())})}async function i(){try{const s=await fetch("/api/profile"),a=document.querySelectorAll(".user-auth-link");if(s.ok){a.forEach(e=>{e.style.display="inline-flex"});const t=await s.json();document.querySelectorAll('a[href="/profile"]').forEach(e=>{const o=e.querySelector("i");e.innerHTML="",o&&e.appendChild(o),e.innerHTML+=` ${t.first_name||"Профиль"}`})}else{a.forEach(e=>{e.style.display="none"});const t=document.querySelector(".hidden.md\\:flex.items-center.space-x-4"),n=document.querySelector("#mobileMenu .px-2.pt-2.pb-3");if(t&&!t.querySelector('a[href="/login"]')){const e=document.createElement("a");e.href="/login",e.className="text-gray-300 hover:text-white transition-colors",e.innerHTML='<i class="fas fa-sign-in-alt mr-1"></i> Войти';const o=t.querySelector('a[href^="https://t.me/"]');t.insertBefore(e,o)}if(n&&!n.querySelector('a[href="/login"]')){const e=document.createElement("a");e.href="/login",e.className="block px-3 py-2 rounded-md text-base font-medium text-white hover:bg-gray-700",e.innerHTML='<i class="fas fa-sign-in-alt mr-1"></i> Войти';const o=n.querySelector('a[href^="https://t.me/"]');n.insertBefore(e,o)}}}catch(s){console.error("Ошибка проверки авторизации:",s)}}
