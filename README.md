# üê± Cat API Telegram Bot & Web Platform

–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å Telegram –±–æ—Ç–æ–º –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ –∫–æ—Ç–æ–≤ —á–µ—Ä–µ–∑ The Cat API. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Clean Architecture**, **Dependency Injection** –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

[![Deploy](https://www.herokucdn.com/deploy/button.svg)](https://www.heroku.com/deploy?template=https://github.com/kotru21/cat-api-telegraf)
[![Run on Replit](https://replit.com/badge/github//kotru21/cat-api-telegraf)](https://replit.com/new/github/kotru21/cat-api-telegraf)

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏](#-–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏)
- [üíª –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
- [üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#Ô∏è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö](#Ô∏è-–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö)
- [üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#Ô∏è-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- [üìä API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#-api-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [ü§ñ Telegram Bot](#-telegram-bot)
- [üåê Web Interface](#-web-interface)
- [üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
- [üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ **Clean Architecture** —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º —Å–ª–æ–µ–≤:

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Å–ª–æ–∏:

- **Presentation Layer**: –í–µ–±-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, Telegram –∫–æ–º–∞–Ω–¥—ã
- **Application Layer**: Use Cases, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- **Domain Layer**: –°–µ—Ä–≤–∏—Å—ã, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- **Infrastructure Layer**: –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, –≤–Ω–µ—à–Ω–∏–µ API, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:

- **Dependency Injection** (Awilix) —Å PROXY —Ä–µ–∂–∏–º–æ–º
- **Repository Pattern** –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
- **Use Case Pattern** –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- **Singleton Pattern** –¥–ª—è Prisma –∫–ª–∏–µ–Ω—Ç–∞
- **Event-Driven Architecture** –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- üé≤ **–°–ª—É—á–∞–π–Ω—ã–µ –∫–æ—Ç—ã** —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ—Ä–æ–¥–∞—Ö
- ‚ù§Ô∏è **–°–∏—Å—Ç–µ–º–∞ –ª–∞–π–∫–æ–≤** —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–µ–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üèÜ **–õ–∏–¥–µ—Ä–±–æ—Ä–¥** —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø–æ—Ä–æ–¥
- üîç **–£–º–Ω—ã–π –ø–æ–∏—Å–∫** –ø–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º (–ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ, —Ç–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç, –≤–µ—Å, –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∂–∏–∑–Ω–∏)
- üì± **Dual Interface**: Telegram –±–æ—Ç + —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- üîÑ **Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** —á–µ—Ä–µ–∑ WebSocket
- üë§ **Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- üõ°Ô∏è **–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: CSP, CORS, Rate Limiting, HELMET
- ‚ö° **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: Connection pooling, singleton services
- üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ (Pino), –º–µ—Ç—Ä–∏–∫–∏
- üîß **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ—Å—Ç—å**: –û—Ç–¥–µ–ª—å–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –±–æ—Ç–∞ –∏ –≤–µ–±–∞
- üöÄ **Production-ready**: Graceful shutdown, health checks, error handling

## ÔøΩ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend:

- **Node.js** v18.18.0+ —Å ES –º–æ–¥—É–ª—è–º–∏
- **Express.js** v4.18.2 - –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
- **Telegraf.js** v4.11.2 - Telegram Bot Framework
- **Prisma ORM** v6.16.2 - —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ë–î
- **Awilix** v12.0.0 - Dependency Injection –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:

- **SQLite** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) / **PostgreSQL** / **MySQL** —á–µ—Ä–µ–∑ Prisma
- **Redis** v5.8.2 - —Å–µ—Å—Å–∏–∏ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø—Ä–æ–¥–∞–∫—à–µ–Ω)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

- **Helmet** v8.1.0 - HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **CORS** v2.8.5 - Cross-Origin Resource Sharing
- **express-rate-limit** v7.5.0 - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- **express-session** v1.18.1 - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏

### Real-time & –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

- **WebSocket** (ws v8.13.0) - real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- **Pino** v9.3.2 - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Zod** v3.23.8 - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ö–µ–º –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### Frontend:

- **Tailwind CSS** v3 - —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–π CSS —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Font Awesome** - –∏–∫–æ–Ω–∫–∏
- **Vanilla JavaScript** - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –±–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
cat-api-telegraf/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ index.js                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ config/                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.js               # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schema.js              # Zod —Å—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ env
‚îÇ   ‚îú‚îÄ‚îÄ application/               # Application Layer (Clean Architecture)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ context.js            # DI –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ executeUseCase
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ errors.js             # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ events.js             # Event emitter –¥–ª—è real-time
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ use-cases/           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (Use Cases)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ getCatDetails.js
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ getRandomCat.js
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ likeCat.js
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ index.js
‚îÇ   ‚îú‚îÄ‚îÄ services/                 # Domain Services
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CatService.js        # –ê–≥—Ä–µ–≥–∞—Ç–æ—Ä —Å–µ—Ä–≤–∏—Å–æ–≤ –∫–æ—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CatInfoService.js    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ—Ç–∞—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LikeService.js       # –°–∏—Å—Ç–µ–º–∞ –ª–∞–π–∫–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LeaderboardService.js # –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –ø–æ—Ä–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ database/                # Infrastructure Layer
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PrismaClient.js  # Singleton Prisma –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CatRepository.js     # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫–æ—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LikesRepository.js   # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ª–∞–π–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ api/                     # External API –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CatApiClient.js      # The Cat API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ bot/                     # Telegram Bot
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BotService.js        # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –±–æ—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commands/            # –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BaseCommand.js   # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FactCommand.js   # /fact –∫–æ–º–∞–Ω–¥–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ MenuCommand.js   # /menu –∫–æ–º–∞–Ω–¥–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ actions/             # Inline –¥–µ–π—Å—Ç–≤–∏—è
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ LikeAction.js    # –î–µ–π—Å—Ç–≤–∏–µ –ª–∞–π–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ web/                     # Web Interface
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ WebServer.js         # Express —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ApiRoutes.js         # API –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ WebSocketServer.js   # WebSocket —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/         # HTTP –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AuthController.js # Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middleware/          # Express middleware
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security.js      # Helmet, CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rateLimiters.js  # Rate limiting
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ session.js       # –°–µ—Å—Å–∏–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ authMiddleware.js # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/              # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ catRoutes.js     # –ú–∞—Ä—à—Ä—É—Ç—ã –∫–æ—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ userRoutes.js    # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authRoutes.js    # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ debugRoutes.js   # –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views/               # HTML —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.html       # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ catDetails.html  # –î–µ—Ç–∞–ª–∏ –∫–æ—Ç–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ similar.html     # –ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile.html     # –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ partials/        # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —á–∞—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ public/              # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ js/navigation.js # –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π JS
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ media/           # –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ di/                      # Dependency Injection
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ container.js         # Awilix –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ utils/                   # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ logger.js            # Pino logger
‚îÇ       ‚îî‚îÄ‚îÄ messageCounter.js    # –°—á–µ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îú‚îÄ‚îÄ prisma/                      # Prisma ORM
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma           # –°—Ö–µ–º–∞ –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ migrations/             # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îú‚îÄ‚îÄ scripts/                    # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ smoke.js               # Smoke —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ check-prisma.js        # –ü—Ä–æ–≤–µ—Ä–∫–∞ Prisma
‚îú‚îÄ‚îÄ public/                    # –ü—É–±–ª–∏—á–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
‚îî‚îÄ‚îÄ package.json              # Node.js –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## ÔøΩüîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**

   ```powershell
   git clone https://github.com/kotru21/cat-api-telegraf.git
   cd cat-api-telegraf
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

   ```powershell
   npm install
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

   –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

   ```env
   # –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
   CATAPI_KEY=your-cat-api-key-from-thecatapi.com

   # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   PORT=5200
   WEBSITE_URL=http://localhost
   WEB_ENABLED=true
   BOT_ENABLED=true
   BOT_TOKEN=your-telegram-bot-token
   SESSION_SECRET=your-secret-key-here
   NODE_ENV=development
   DATABASE_URL=file:./prisma/main.db
   ```

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:**

   ```powershell
   npm run prisma:generate
   npm run prisma:migrate:dev
   ```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```powershell
   npm start
   ```

### –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–µ–π

1. **The Cat API –∫–ª—é—á:**

   - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [thecatapi.com](https://thecatapi.com/)
   - –ü–æ–ª—É—á–∏—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π API –∫–ª—é—á
   - –î–æ–±–∞–≤—å—Ç–µ –≤ `.env` –∫–∞–∫ `CATAPI_KEY`

2. **Telegram Bot Token:**
   - –ù–∞–ø–∏—à–∏—Ç–µ [@BotFather](https://t.me/botfather) –≤ Telegram
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π `/newbot`
   - –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ `.env` –∫–∞–∫ `BOT_TOKEN`

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Zod** –¥–ª—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è       | –¢–∏–ø     | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é            | –û–ø–∏—Å–∞–Ω–∏–µ                               |
| ---------------- | ------- | ----------------------- | -------------------------------------- |
| `CATAPI_KEY`     | string  | **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ**         | API –∫–ª—é—á The Cat API                   |
| `PORT`           | number  | `5200`                  | –ü–æ—Ä—Ç HTTP/WebSocket —Å–µ—Ä–≤–µ—Ä–∞            |
| `WEBSITE_URL`    | string  | `http://localhost`      | –ë–∞–∑–æ–≤—ã–π URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è                 |
| `WEB_ENABLED`    | boolean | `true`                  | –í–∫–ª—é—á–∏—Ç—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä                    |
| `BOT_ENABLED`    | boolean | `true`                  | –í–∫–ª—é—á–∏—Ç—å Telegram –±–æ—Ç–∞                 |
| `BOT_TOKEN`      | string  | –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ\*           | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞                    |
| `SESSION_SECRET` | string  | `your-secret-key-here`  | –°–µ–∫—Ä–µ—Ç –¥–ª—è —Å–µ—Å—Å–∏–π                      |
| `NODE_ENV`       | enum    | `development`           | –û–∫—Ä—É–∂–µ–Ω–∏–µ: development/test/production |
| `DATABASE_URL`   | string  | `file:./prisma/main.db` | –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î                |
| `REDIS_URL`      | string  | –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ\*\*         | URL Redis –¥–ª—è —Å–µ—Å—Å–∏–π                   |

**\*** –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ `BOT_ENABLED=true`  
**\*\*** –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

```powershell
# –¢–æ–ª—å–∫–æ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
$env:WEB_ENABLED='true'; $env:BOT_ENABLED='false'; npm start

# –¢–æ–ª—å–∫–æ Telegram –±–æ—Ç
$env:WEB_ENABLED='false'; $env:BOT_ENABLED='true'; npm start

# –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
$env:WEB_ENABLED='true'; $env:BOT_ENABLED='true'; npm start
```

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Prisma ORM** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ë–î:

### –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

```prisma
model msg {
  id              String   @id
  count           Int      @default(0)
  breed_name      String?
  image_url       String?
  description     String?
  wikipedia_url   String?
  breed_id        String?
  temperament     String?
  origin          String?
  life_span       String?
  weight_imperial String?
  weight_metric   String?
  created_at      DateTime @default(now())

  user_likes user_likes[]
  @@index([count], map: "idx_msg_count")
}

model user_likes {
  id      Int    @id @default(autoincrement())
  user_id String
  cat_id  String
  msg     msg    @relation(fields: [cat_id], references: [id])

  @@unique([user_id, cat_id])
}
```

### –ö–æ–º–∞–Ω–¥—ã Prisma

```powershell
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã
npm run prisma:generate

# –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
npm run prisma:migrate:dev

# –ó–∞–ø—É—Å–∫ Prisma Studio (GUI –¥–ª—è –ë–î)
npm run prisma:studio

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
npm run prisma:check
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ë–î

- **SQLite** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **PostgreSQL** - –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- **MySQL/MariaDB** - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

–ü—Ä–∏–º–µ—Ä –¥–ª—è PostgreSQL:

```env
DATABASE_URL="postgresql://username:password@localhost:5432/catapi?schema=public"
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

### HTTP Security (Helmet.js)

```javascript
// Content Security Policy
contentSecurityPolicy: {
  directives: {
    defaultSrc: ["'self'"],
    scriptSrc: ["'self'", "cdn.tailwindcss.com", "telegram.org"],
    styleSrc: ["'self'", "'unsafe-inline'", "cdn.tailwindcss.com"],
    imgSrc: ["'self'", "data:", "https://*"],
    connectSrc: ["'self'", "ws:", "wss:", "telegram.org"]
  }
}
```

### Rate Limiting

```javascript
// API –æ–±—â–∏–π –ª–∏–º–∏—Ç: 100 –∑–∞–ø—Ä–æ—Å–æ–≤ / 15 –º–∏–Ω—É—Ç
// –õ–∏–¥–µ—Ä–±–æ—Ä–¥: 30 –∑–∞–ø—Ä–æ—Å–æ–≤ / 5 –º–∏–Ω—É—Ç
// Telegram –±–æ—Ç: 3 —Å–æ–æ–±—â–µ–Ω–∏—è / 3 —Å–µ–∫—É–Ω–¥—ã
// WebSocket: 10 —Å–æ–æ–±—â–µ–Ω–∏–π / 5 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- **Telegram Login Widget** —Å HMAC –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- **Express Sessions** —Å HttpOnly cookies
- **Redis store** –¥–ª—è —Å–µ—Å—Å–∏–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- **CSRF –∑–∞—â–∏—Ç–∞** —á–µ—Ä–µ–∑ SameSite cookies

### –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

```javascript
// Zod —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
// Sanitization –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
// –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è ID –∫–æ—Ç–æ–≤: /^[a-zA-Z0-9_-]+$/
```

## üìä API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ë–∞–∑–æ–≤—ã–π URL

```
http://localhost:5200/api
```

### –ö–æ—Ç—ã (Cats)

#### –ü–æ–ª—É—á–∏—Ç—å –∫–æ—Ç–∞ –ø–æ ID

```http
GET /api/cat/:id

Response 200:
{
  "id": "abcd1234",
  "breed_name": "British Shorthair",
  "image_url": "https://...",
  "description": "...",
  "temperament": "Calm, Easy Going",
  "origin": "United Kingdom",
  "life_span": "12 - 17",
  "weight_metric": "4 - 8",
  "count": 5
}
```

#### –ü–æ–ª—É—á–∏—Ç—å –ª–∏–¥–µ—Ä–±–æ—Ä–¥

```http
GET /api/leaderboard

Response 200:
[
  {
    "breed_name": "British Shorthair",
    "total_likes": 15,
    "image_url": "https://..."
  }
]
```

#### –ü–æ–∏—Å–∫ –ø–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º

```http
GET /api/similar?feature=origin&value=Russia

Parameters:
- feature: origin|temperament|life_span|weight_metric|weight_imperial
- value: —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞

Response 200:
[
  {
    "id": "xyz789",
    "breed_name": "Russian Blue",
    "image_url": "https://...",
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
  }
]
```

#### –°–ª—É—á–∞–π–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

```http
GET /api/random-images?count=3

Response 200:
{
  "images": [
    {
      "id": "img1",
      "url": "https://...",
      "width": 800,
      "height": 600
    }
  ]
}
```

### –õ–∞–π–∫–∏ (Likes)

#### –ü–æ—Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫ (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

```http
POST /api/like
Content-Type: application/json

{
  "catId": "abcd1234"
}

Response 200:
{
  "ok": true,
  "newCount": 6
}
```

#### –£–±—Ä–∞—Ç—å –ª–∞–π–∫ (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

```http
DELETE /api/like
Content-Type: application/json

{
  "catId": "abcd1234"
}

Response 200:
{
  "ok": true
}
```

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (Users)

#### –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

```http
GET /api/profile

Response 200:
{
  "id": "12345",
  "first_name": "John",
  "username": "john_doe",
  "photo_url": "https://..."
}
```

#### –õ–∞–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

```http
GET /api/mylikes

Response 200:
[
  {
    "id": "abcd1234",
    "breed_name": "British Shorthair",
    "image_url": "https://..."
  }
]
```

#### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

```http
GET /api/user/likes/count

Response 200:
{
  "count": 5
}
```

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

#### Telegram Login

```http
POST /api/auth/telegram
Content-Type: application/json

{
  "id": "12345",
  "first_name": "John",
  "username": "john_doe",
  "photo_url": "https://...",
  "auth_date": "1634567890",
  "hash": "abc123..."
}

Response 200:
{
  "success": true,
  "redirect": "/profile"
}
```

### Health Checks

```http
GET /healthz   # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
GET /readyz    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
```

### Error Responses

```json
// 400 Bad Request
{
  "error": "Invalid ID format"
}

// 401 Unauthorized
{
  "error": "Unauthorized"
}

// 429 Too Many Requests
{
  "error": "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ"
}

// 500 Internal Server Error
{
  "error": "Internal Server Error"
}
```

## ü§ñ Telegram Bot

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞    | –û–ø–∏—Å–∞–Ω–∏–µ           | –ü—Ä–∏–º–µ—Ä                     |
| ---------- | ------------------ | -------------------------- |
| `/start`   | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –º–µ–Ω—é | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é    |
| `/menu`    | –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é       | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏       |
| `/fact`    | –°–ª—É—á–∞–π–Ω—ã–π –∫–æ—Ç      | –§–æ—Ç–æ + –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Ä–æ–¥–µ |
| `/mylikes` | –ú–æ–∏ –ª–∞–π–∫–∏          | –°–ø–∏—Å–æ–∫ –ª–∞–π–∫–Ω—É—Ç—ã—Ö –∫–æ—Ç–æ–≤     |
| `/top`     | –õ–∏–¥–µ—Ä–±–æ—Ä–¥          | –¢–æ–ø –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø–æ—Ä–æ–¥       |

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

- **‚ù§Ô∏è –õ–∞–π–∫** - –ø–æ—Å—Ç–∞–≤–∏—Ç—å/—É–±—Ä–∞—Ç—å –ª–∞–π–∫ –∫–æ—Ç—É
- **üîç –ü–æ—Ö–æ–∂–∏–µ** - –Ω–∞–π—Ç–∏ –∫–æ—Ç–æ–≤ —Å –ø–æ—Ö–æ–∂–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
- **üìä –õ–∏–¥–µ—Ä–±–æ—Ä–¥** - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–æ—Ä–æ–¥—ã
- **üé≤ –ï—â–µ –∫–æ—Ç** - –ø–æ–ª—É—á–∏—Ç—å –µ—â–µ –æ–¥–Ω–æ–≥–æ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∫–æ—Ç–∞

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞

- **Rate Limiting**: –º–∞–∫—Å–∏–º—É–º 3 –∫–æ–º–∞–Ω–¥—ã –∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã
- **Graceful Errors**: –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è**: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–∞–π–∫–æ–≤ –ø–æ user_id
- **Rich Media**: –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è + –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–æ—Ç–∞

```javascript
// –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –∫–æ–º–∞–Ω–¥ —Å DI
class BaseCommand {
  constructor(name, description) {
    this.container = null; // Awilix DI container
  }

  // –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ use-cases
  async executeUseCase(useCaseFn, params, ctx) {
    const appCtx = this.createAppContext();
    return executeUseCase(useCaseFn, appCtx, params, meta);
  }
}

// –ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã
class FactCommand extends BaseCommand {
  constructor() {
    super("fact", "–ü–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∫–æ—Ç–∞");
    this.composer.command("fact", this.handleFact.bind(this));
  }
}
```

## üåê Web Interface

### –°—Ç—Ä–∞–Ω–∏—Ü—ã

#### –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (`/`)

- **Real-time —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** —á–µ—Ä–µ–∑ WebSocket
- **–°–ª—É—á–∞–π–Ω—ã–µ –∫–æ—Ç—ã** –≤ hero —Å–µ–∫—Ü–∏–∏
- **–ë—ã—Å—Ç—Ä–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è** –∫ –æ—Å–Ω–æ–≤–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω** –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

#### –î–µ—Ç–∞–ª–∏ –∫–æ—Ç–∞ (`/catDetails?id=:id`)

- **–ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** –æ –ø–æ—Ä–æ–¥–µ
- **–í—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ**
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è** (–ª–∞–π–∫, –ø–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö)
- **–°—Å—ã–ª–∫–∞ –Ω–∞ Wikipedia**

#### –ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö (`/similar?feature=:feature&value=:value`)

- **–£–º–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** –ø–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º
- **–°–µ—Ç–∫–∞ –∫–æ—Ç–æ–≤** —Å lazy loading
- **–î–µ—Ç–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏** —Å –±—ã—Å—Ç—Ä—ã–º –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º

#### –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`/profile`)

- **Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** required
- **–õ–∏—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –ª–∞–π–∫–æ–≤
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–æ—Ç—ã**

#### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (`/login`)

- **Telegram Login Widget**
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç** –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

#### Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```javascript
// WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è live —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
const ws = new WebSocket("ws://localhost:5200/wss");

// –°–æ–±—ã—Ç–∏—è:
// - messageCountUpdate: –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç–∞
// - leaderboardUpdate: –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–µ
// - timeUpdate: —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è —Å–µ—Ä–≤–µ—Ä–∞
```

#### Responsive Design

- **Mobile-first** –ø–æ–¥—Ö–æ–¥
- **Tailwind CSS** utility-first
- **Flexbox/Grid** layouts
- **Dark theme** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

#### Progressive Enhancement

- **Core functionality** —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ JavaScript
- **Enhanced UX** —Å JavaScript –≤–∫–ª—é—á–µ–Ω–Ω—ã–º
- **Graceful degradation** –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤

#### Performance

- **Lazy loading** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **Skeleton loaders** –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
- **Debounced** API calls
- **Connection pooling** –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Production Requirements

```env
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
NODE_ENV=production
SESSION_SECRET=complex-random-string-min-32-chars
REDIS_URL=redis://localhost:6379
DATABASE_URL=postgresql://user:pass@host:5432/db

# Telegram (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –±–æ—Ç)
BOT_TOKEN=your-production-bot-token

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
WEBSITE_URL=https://yourdomain.com
```

### Docker Deployment

```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
RUN npm run prisma:generate
EXPOSE 5200
CMD ["npm", "start"]
```

```yaml
# docker-compose.yml
version: "3.8"
services:
  app:
    build: .
    environment:
      - NODE_ENV=production
      - DATABASE_URL=postgresql://postgres:password@db:5432/catapi
      - REDIS_URL=redis://redis:6379
    depends_on:
      - db
      - redis
    ports:
      - "5200:5200"

  db:
    image: postgres:15
    environment:
      POSTGRES_DB: catapi
      POSTGRES_PASSWORD: password
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine

volumes:
  postgres_data:
```

### Heroku Deployment

```bash
# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
heroku create your-app-name
heroku addons:create heroku-postgresql:mini
heroku addons:create heroku-redis:mini

# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
heroku config:set NODE_ENV=production
heroku config:set CATAPI_KEY=your-key
heroku config:set SESSION_SECRET=your-secret
heroku config:set BOT_TOKEN=your-bot-token

# –î–µ–ø–ª–æ–π
git push heroku main
```

### Health Monitoring

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
curl https://yourdomain.com/healthz
curl https://yourdomain.com/readyz

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤
heroku logs --tail
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Smoke Tests

```powershell
# –ó–∞–ø—É—Å–∫ smoke —Ç–µ—Å—Ç–æ–≤
npm run smoke

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Prisma –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
npm run prisma:check
```

### Manual Testing

```powershell
# –¢–µ—Å—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
Start-Process "http://localhost:5200"

# –¢–µ—Å—Ç API endpoints
Invoke-RestMethod -Uri "http://localhost:5200/api/leaderboard" -Method GET

# –¢–µ—Å—Ç WebSocket
# –û—Ç–∫—Ä—ã—Ç—å Developer Tools –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
```

### Production Validation

```bash
# Health checks
curl -f https://yourdomain.com/healthz || exit 1
curl -f https://yourdomain.com/readyz || exit 1

# Performance test
curl -w "@curl-format.txt" -s -o /dev/null https://yourdomain.com/
```

---

## ü§ù Contributing

1. Fork –ø—Ä–æ–µ–∫—Ç
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤ branch (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìÑ License

Distributed under the ISC License. See `LICENSE` for more information.

## üîó Links

- **GitHub Repository**: [kotru21/cat-api-telegraf](https://github.com/kotru21/cat-api-telegraf)
- **The Cat API**: [thecatapi.com](https://thecatapi.com/)
- **Telegram Bot API**: [core.telegram.org/bots](https://core.telegram.org/bots)

---

‚≠ê **–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –±—ã–ª –ø–æ–ª–µ–∑–µ–Ω, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥–æ—á–∫—É –Ω–∞ GitHub!** ‚≠ê
